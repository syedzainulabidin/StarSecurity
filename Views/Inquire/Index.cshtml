@{
    ViewData["Title"] = "Check Your Status";
}

<section class="relative min-h-[calc(100vh-88px)] flex flex-col items-center justify-center px-8 lg:px-16">

    <!-- Background Text -->
    <div class="absolute inset-0 z-0 flex flex-col items-center justify-center pointer-events-none select-none overflow-hidden">
        <h2 class="text-[8rem] lg:text-[15rem] font-anton leading-none tracking-tighter opacity-10 uppercase text-transparent text-stroke">
            STATUS
        </h2>
        <h2 class="text-[8rem] lg:text-[15rem] font-anton leading-none tracking-tighter opacity-20 uppercase -mt-10 lg:-mt-20">
            INQUIRY
        </h2>
    </div>

    <div class="relative z-10 w-full max-w-xl">
        <div class="glass-card p-10 lg:p-16 rounded-[3rem] shadow-2xl">
            <div class="mb-10 text-center">
                <div class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-1.5 text-xs font-medium mb-4">
                    <div class="h-2 w-2 rounded-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.8)]"></div>
                    Track Your Progress
                </div>
                <h1 class="text-4xl lg:text-5xl font-anton uppercase tracking-tight mb-4">
                    Check Your <span class="text-blue-600">Status</span>
                </h1>
                <p class="text-gray-400 font-medium">Enter your details below to check your booking or application status.</p>
            </div>

            <form method="post" asp-controller="Inquire" asp-action="Check" class="space-y-6">
                <div>
                    <label class="block text-xs font-bold uppercase tracking-widest text-gray-500 mb-2 ml-1">Enter your email address:</label>
                    <div class="relative group">
                        <input type="email" name="email" required
                               class="w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 outline-none focus:border-blue-600 focus:ring-1 focus:ring-blue-600 transition-all text-white placeholder:text-white/20"
                               placeholder="email@example.com">
                        <div class="absolute inset-0 rounded-2xl bg-blue-600/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"></div>
                    </div>
                </div>

                <button type="submit" class="w-full bg-blue-600 py-4 rounded-2xl font-bold uppercase tracking-widest text-sm hover:bg-blue-700 transition-all shadow-lg shadow-blue-600/20">
                    Check Status
                </button>
            </form>

            <!-- Display Messages -->
            @if (ViewBag.Error != null)
            {
                <div class="mt-6 p-4 bg-red-900/30 border border-red-500/30 rounded-xl text-red-300">
                    <div class="flex items-center gap-3">
                        <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>@ViewBag.Error</span>
                    </div>
                </div>
            }

            @if (ViewBag.NotFound != null)
            {
                <div class="mt-6 p-4 bg-yellow-900/30 border border-yellow-500/30 rounded-xl text-yellow-300">
                    <div class="flex items-center gap-3">
                        <svg class="w-5 h-5 text-yellow-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.998-.833-2.732 0L4.346 16.5c-.77.833.192 2.5 1.732 2.5z" />
                        </svg>
                        <span>No record found</span>
                    </div>
                </div>
            }

            <!-- Display Results -->
            @if (ViewBag.Type == "booking" && ViewBag.Bookings != null)
            {
                <div class="mt-8 pt-8 border-t border-white/10">
                    <h4 class="text-2xl font-bold mb-6 text-blue-300">Your Bookings</h4>
                    <div class="space-y-4">
                        @foreach (var booking in ViewBag.Bookings)
                        {
                            <div class="bg-white/5 border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition-all">
                                <div class="flex justify-between items-start mb-4">
                                    <h5 class="text-xl font-bold">Booking #@booking.Id</h5>
                                    <span class="text-sm font-bold text-gray-400">@booking.Date.ToShortDateString()</span>
                                </div>

                                <div class="space-y-3">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                        </svg>
                                        <span class="text-gray-300"><strong>Service:</strong> @booking.Service.Title</span>
                                    </div>

                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        <span class="text-gray-300">
                                            <strong>Status:</strong>
                                            @if (booking.Status == "Pending")
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-yellow-900/50 text-yellow-300 border border-yellow-500/30">Under Review</span>
                                            }
                                            else if (booking.Status == "Approved")
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-green-900/50 text-green-300 border border-green-500/30">Approved</span>
                                            }
                                            else
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-red-900/50 text-red-300 border border-red-500/30">Rejected</span>
                                            }
                                        </span>
                                    </div>

                                    @if (booking.Status == "Approved" && booking.Employee != null)
                                    {
                                        <div class="mt-4 p-4 bg-blue-900/20 rounded-xl border border-blue-500/20">
                                            <div class="flex items-center gap-3">
                                                <div class="w-10 h-10 rounded-full bg-blue-600/30 flex items-center justify-center">
                                                    <svg class="w-5 h-5 text-blue-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                                    </svg>
                                                </div>
                                                <div>
                                                    <p class="text-sm text-gray-300"><strong>Assigned Staff:</strong> @booking.Employee.Name</p>
                                                    <p class="text-sm text-gray-400"><strong>Contact:</strong> @booking.Employee.Contact</p>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }

            @if (ViewBag.Type == "application" && ViewBag.AppResults != null)
            {
                <div class="mt-8 pt-8 border-t border-white/10">
                    <h4 class="text-2xl font-bold mb-6 text-blue-300">Your Job Applications</h4>
                    <div class="space-y-4">
                        @foreach (var item in ViewBag.AppResults)
                        {
                            var app = item.App;
                            var isDefaultPassword = item.IsDefaultPassword;

                            <div class="bg-white/5 border border-white/10 rounded-2xl p-6 hover:bg-white/10 transition-all">
                                <div class="flex justify-between items-start mb-4">
                                    <h5 class="text-xl font-bold">Application for @app.Vacancy?.Service?.Title</h5>
                                    <span class="text-sm font-bold text-gray-400">@app.CreatedAt.ToString("dd-MM-yyyy")</span>
                                </div>

                                <div class="space-y-3">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        <span class="text-gray-300">
                                            <strong>Status:</strong>
                                            @if (app.Status == "Pending")
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-yellow-900/50 text-yellow-300 border border-yellow-500/30">Under Review</span>
                                            }
                                            else if (app.Status == "Hired")
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-green-900/50 text-green-300 border border-green-500/30">Hired</span>
                                            }
                                            else
                                            {
                                                <span class="ml-2 px-3 py-1 rounded-full text-xs font-bold bg-red-900/50 text-red-300 border border-red-500/30">Rejected</span>
                                            }
                                        </span>
                                    </div>

                                    @if (app.Status == "Hired" && isDefaultPassword == true)
                                    {
                                        <div class="mt-4 p-4 bg-blue-900/20 rounded-xl border border-blue-500/20">
                                            <div class="flex items-start gap-3">
                                                <div class="w-10 h-10 rounded-full bg-green-600/30 flex items-center justify-center flex-shrink-0">
                                                    <svg class="w-5 h-5 text-green-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                                    </svg>
                                                </div>
                                                <div>
                                                    <p class="text-sm text-gray-300 mb-2"><strong>Your Login Credentials:</strong></p>
                                                    <div class="space-y-1 text-sm">
                                                        <p><span class="text-gray-400">Email:</span> <span class="text-blue-300">@app.Email</span></p>
                                                        <p><span class="text-gray-400">Password:</span> <span class="text-blue-300">Default@123</span></p>
                                                        <p class="text-xs text-gray-500 mt-2">Please change your password after first login.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    else if (app.Status == "Hired")
                                    {
                                        <div class="mt-3 p-3 bg-green-900/20 rounded-xl border border-green-500/20">
                                            <div class="flex items-center gap-2">
                                                <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                                                </svg>
                                                <span class="text-green-300 text-sm">You have been hired. Please log in to your account.</span>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }

            <div class="mt-12 pt-8 border-t border-white/5 flex flex-col items-center gap-4">
                <p class="text-xs text-gray-500 font-bold uppercase tracking-[0.2em]">Need Assistance?</p>
                <div class="flex gap-4">
                    <a href="/contact" class="text-sm font-bold text-blue-500 hover:text-white transition-colors">Contact Support</a>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .text-stroke {
        -webkit-text-stroke: 1px rgba(255, 255, 255, 0.3);
    }

    .glass-card {
        background: rgba(2, 6, 23, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .group:hover .group-hover\:opacity-100 {
        opacity: 1;
    }

    button:hover {
        transform: translateY(-2px);
    }

    .hover\:bg-white\/10:hover {
        background: rgba(255, 255, 255, 0.1);
    }
</style>